---
title: "Measures of Political Behavior"
author: "Daniel Marcelino"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_vignette:
    number_sections: yes
    toc_depth: 2
    toc: yes
    fig_width: 5
abstract: This tutorial describes some of the indices on political behavior that are most visible in scholarly literature, along with measures of political diversity, methods of seats allocation, and methods for graphically displaying results. The framework is provided by the R package **SciencesPo**--version `r packageVersion("SciencesPo")`--, but other packages are used to help with various tasks.
vignette: >
  %\VignetteIndexEntry{Measures of Political Behavior}
   %\VignetteEngine{knitr::rmarkdown}
    \usepackage[T1]{fontenc}
     \usepackage[utf8]{inputenc}
---

  
# Introduction

This vignette describes a number of applications available in the R library **SciencesPo** for computing some of the most visible indices in the scholarship. These indices are important political abstractions because they provide grounding for categorizing units; therefore, making the way for causal comparision. Examples at the core of the discipline include measures of political concentration/fragmentation, political competition, and apportionment methods used to translate votes into seats.

This document is structured as follows. Section 2 gives a technical overview of the function, formulas, and examples of seat apportionment methods. Section 3 illustrates the use of political diversity methods to obtain empirical statistics of a political system environment, such as the effective number of parties, the nationalization of political parties, and political competition. Section 4 provides examples of computing proportionality measures. Section 5 ends with inequality measures. 

# Seat Apportionment Methods 

Most democratic countries use apportionment methods to transform election results into whole numbers, which in turn indicate the number of seats that each party earns in a legislative body, administrative council, or committee. Which apportionment method does this best is not a trivial topic for mathematicians as well as for political scientists. Actually, several formulas have been proposed since the early time of representative assemblies. The following sections briefly present some of these allotment methods.

## Highest Averages Methods of Allocating Seats Proportionally

Highest averages methods allocate seats proportionally to the number of votes by assigning seats in a way that assures the highest quotient by seat for each party. Other methods divide the votes by a mathematically derived quota, such as Droop and Hare quotas. In what follows are illustrative examples taken from Lijphart (1994) of the operation of some highest averages formulas in a six member district with four parties.

```{r table_A.1, echo=TRUE, cache=TRUE}
# Table A.l
lijphart <- c("A"=41000, "B"=29000,"C"=17000, "D"=13000)
```

The basic imputs for this class of functions are: 1) a list of parties, 2) a list of positive votes, and 3) a constant value for the number of seats to be returned. A numeric value (0~1) for the threshold is optional.

By default, the function prints the apportionment method being used, a snippet of the divisors used, the effective number of parties (or candidates) index for both before and after the seat allocation method takes place, and the least squares index--or Gallager index.
The effective number of parties measured the before seat allocation is a measure of the  party system fragmentation, once it deals with the effective number of parties at the electoral level, while the index computed after the seat allocation, the effective number of parliamentary parties. The Gallager index is an indication of the disproportionality and runs from 0 to 100. The higher the value, the higher the disproportionality of the election outcome. 

### d'Hondt
Under the D'Hondt formula, seats are allocated using divisors of 1, 2, 3, 4, etc. Thus, suggesting that the divisors are simply one more than the number of seats that party already has. 


```{r highestAverages1, message=FALSE, comment=NA}
library("SciencesPo", quietly = TRUE)

# The d'Hondt will give the same results as Jefferson's method
HighestAverages(parties=names(lijphart),
                votes=lijphart,
                seats = 6, 
                method = "dh") 
```

The d'Hondt is only one way of allocating seats in party list systems. Other methods include the Saint-Laguë, the modified Saint-Laguë, the Danish version, Imperiali (do not to confuse with the Imperiali quota, which is a Largest remainder method), Hungtinton-Hill, Webster, etc. 


### Saint-Laguë

Named after its founder, the pure Sainte-Laguë formula, also known as Schepers method, uses the odd-integer divisor series (1, 3, 5, 7, ...) to elect candidates from political parties in approximate proportion as the proportion of votes won by the party. The outcome would be the same as the outcome produced by the Webster's divisors method.

```{r highestAverages2, echo=TRUE, message=FALSE, comment=NA}
# The Sainte-Laguë will give the same results as the Webster's method (wb)
HighestAverages(parties=names(lijphart),
                votes=lijphart,
                seats = 6,
                method = "sl") 
```

### Modified Saint-Laguë

The modified Sainte-Laguë use divisors of 1.4, 3, 5, 7, etc. How does the d'Hondt divisor compare to the Modified Sainte-Laguë one? Which divisor method tend to favor larger parties and which one smaller parties?

```{r highestAverages3, echo=TRUE, message=FALSE, comment=NA}
HighestAverages(parties=names(lijphart),
                votes=lijphart, 
                seats = 6,
                method = "msl") 
```


### Danish

The Danish divisors (1, 4, 7, 10, ...) increase so fast that large parties are quickly cut down, acting much to the benefit of smaller parties.

```{r highestAverages4, echo=TRUE, message=FALSE, comment=NA}
HighestAverages(parties=names(lijphart), 
                votes=lijphart, 
                seats = 6, 
                method = "danish") 
```

### Hungarian

The Hungarian version of Sainte-Laguë uses divisors of (1.5, 3, 5, 7, 9, ...) increase so fast that large parties are quickly cut down, acting much to the benefit of smaller parties.

```{r highestAverages5, echo=TRUE, message=FALSE, comment=NA}
HighestAverages(parties=names(lijphart),
                votes=lijphart, 
                seats = 6, 
                method = "hsl") 
```


### Webster

This approach does not use a standard divisor either. It uses instead a different divisor and modified quota such that rounding with cut-off point at *algebraic* mean of lower and upper quotas: wb = $\frac{L + (L + 1)}{2}$.

```{r highestAverages6, echo=TRUE, message=FALSE, comment=NA}
HighestAverages(parties=names(lijphart),
                votes=lijphart, 
                seats = 6, 
                method = "wb") 
```


### Imperiali

The Italian Imperiali divisor system has a slowly-increasing sequence (1, 1.5, 2, 2.5, 3, ...), with 0.5 difference between consecutive divisors. This is tighter than the d'Hondt divisors for which this difference is 1. Like d'Hondt, the Imperiali system is designed to encourage coalitions and secure majority governments under a PR system, but the Imperiali will be the most favourable to large parties as they will gain many seats before their quotients are reduced below those of the smaller parties.

```{r highestAverages7, echo=TRUE, message=FALSE, comment=NA}
HighestAverages(parties=names(lijphart),
                votes=lijphart, 
                seats = 6, 
                method = "imperiali") 
```

The Belgian municipal councils were elected by the Imperiali highest averages method. The following example comes from the 2006 election in Bruges, where 47 seats were upon.

```{r highestAverages8, echo=TRUE, message=FALSE, comment=NA}
Bruges=c("CD&V/N-VA"=32092, "SP.A/Spirit"=20028, 
         "Flemish Interest"=13408, "Open VLD/Vivant"=9520,
         "Green!"=5328, "Other"=2207)

HighestAverages(parties=names(Bruges),
                votes=Bruges, 
                seats = 47,
                method = "imperiali") 
```

### Hungtinton-Hill

The method proposed by Joseph Hill and Edward Huntington does not use a standard divisor, but a different one and also a modified quota such that rounding with cut-off point at *geometric* mean: hh = $\sqrt{L(L + 1)}$. This method makes sense only if every party is guaranteed at least one seat. It has been used for allotting seats in the US House of Representatives to the states.


```{r highestAverages9, echo=TRUE, message=FALSE, comment=NA}
HighestAverages(parties=names(lijphart),
                votes=lijphart, 
                seats = 6, method = "hh") 
```

### Using Thresholds

Let's assume that we have an election with 1,000 total voters in which five parties (A, B, C, D, and E) have gained 100 (10\%), 150 (15\%), 300 (30\%), 400 (40\%), and 50 (5\%) votes, respectively. In this electoral constituency, there are 3 seats up for election, and all votes cast are valid. The electoral system has a 7\% vote threshold, meaning that parties must get at least 7\% of the total unspoiled votes cast in order to participate in the distribution of seats. Party *E* would then be elimiated from competition at the outset. 

If the d'Hondt method of seat allocation were employed in this hypothetical election, then party *C* would get 1 seat (or 33\% of the number of seats), and party *D* 2 seats (or 67\% of the seats).

```{r highestAverages10, echo=TRUE, message=FALSE, comment=NA}

const <- c("A"=100, "B"=150,"C"=300, "D"=400, "E"=50)

HighestAverages(parties=names(const),
                votes=const,
                seats = 3, method = "dh",
                threshold = 7/100) 
```


The following example is taken from the 2015 general elections in Spain. The region of Valencia returned 15 seats allocated using the D'Hondt method in a closed list PR system. Only lists that poll at least 3% of the total vote (which includes expoiled votes "en blanco") can be considered.

```{r Valencia-election, echo=FALSE, cache=TRUE, comment=NA}
(Valencia <- c("PP"=442005, "Podemos"=395729, "PSOE"=275680,
              "C's"=221299, "IU"=68759, "PACMA"=14445, "Others"=35943)) 
blanco=8738
nulo=11891
```

```{r Valencia, echo=TRUE, message=FALSE, comment=NA}
# Valencia returned 15 members
HighestAverages(parties=names(Valencia),
                votes=Valencia, 
                seats=15, method = "dh",
                threshold = 3/100)
```


Next, the methods that divide the votes by a mathematically derived quota, such as the Droop quota, the Hare quota (or Hamilton/Vinton), and the Imperiali quota. 


## Largest Remainder Methods of Allocating Seats Proportionally

Highest averages methods allocate seats proportionally to the number of votes by dividing the number of votes required for each party by a quota. The quota may vary because it is the result of dividing the number of unspoiled votes ($v$) by some whole number close to the number of seats that would next be assigned ($s$). In what follows are llustrative examples of the operation of some largest remainders formulas in an eight member district with the same four parties of the previous examples.

### Hare quota
The Droop quota is obtained by quota = $\frac{v}{(s)}$.

```{r largestRemainders1, eval=FALSE, echo=TRUE, message=FALSE, comment=NA}
LargestRemainders(parties=names(lijphart),
                  votes=lijphart, 
                  seats = 8, method = "hare") 
```

### Droop quota
The Droop quota is obtained by quota = $\frac{v}{(s + 1)}+1$.

```{r largestRemainders2, eval=FALSE, echo=TRUE, message=FALSE, comment=NA}
LargestRemainders(parties=names(lijphart), 
                  votes=lijphart, 
                  seats = 8, method = "droop") 
```


### Hagenbach-Bischoff
The Hagenbach-Bischoff quota is obtained by $\frac{v}{(s + 1)}$.

```{r largestRemainders3, eval=FALSE, echo=TRUE, message=FALSE, comment=NA}
LargestRemainders(parties=names(lijphart),
                  votes=lijphart, 
                  seats = 8, method = "hagb") 
```


### Imperiali quota
The Imperiali quota is obtained by $\frac{v}{(s + 2)}$. For Italian elections during the 1950s, the quota used was a reinforced version of the quota: $\frac{v}{(s + 3)}$.
 
```{r data-Italy, eval=FALSE, echo=TRUE, message=FALSE}
# The 1946 Italian Constituent Assembly election results: parties and unspoilt votes

Italy = data.frame(party=c("DC", "PSIUP", "PCI", "UDN", "UQ", "PRI",
                            "BNL", "PdA", "MIS", "PCd'I", "CDR",
                           "PSd'Az", "MUI", "PCS", "PDL", "FDPR"),
                   votes=c(8101004, 4758129, 4356686, 1560638,	1211956,
                           1003007, 637328, 334748, 171201, 102393,
                           97690, 78554, 71021, 51088, 40633, 21853))
```

```{r largestRemainders4, eval=FALSE, echo=TRUE, message=FALSE, comment=NA}
with(Italy, LargestRemainders(parties=party,
                              votes=votes, seats = 556,
                              method = "imperiali.q") )
```


## Suitable output for recycling within RMarkdown documents 

The output produced by `highestAverages()` and `largestRemainders()`  functions is of class `data.frame`, which R users are already familiar with and makes the process of using with other aplications very straightforward too. Let's take the data from 2014 Brazilian legislative elections. I will look especifically at one electoral district--the state of Ceará--to compare how that caucus would look like if different apportionment methods were used with voters' preference kept constant.

```{r Ceara-election, echo=TRUE, cache=TRUE}
# Results for the state legislative house of Ceará (2014):
Ceara <- c("PCdoB"=187906, "PDT"=326841,"PEN"=132531, "PMDB"=981096,
           "PRB"=2043217,"PSB"=15061, "PSC"=103679, "PSTU"=109830,
           "PTdoB"=213988, "PTC"=67145, "PTN"=278267)
```

Once the data is loaded, producing a table with seat apportionment results is effortless with packages like **knitr**, **pander**, **gtable**, **xtable**, etc. In the following, I demonstrate this using the `kable()` function from the **knitr** package.

```{r highestAverages11, echo=TRUE, message=FALSE, comment=NA}
mytable = HighestAverages(parties=names(Ceara), 
                          votes=Ceara,
                          seats = 42, method = "dh") 

library(knitr)

kable(mytable, align=c("l","c","c"), caption="Outcome under d'Hondt")
```

If you rather prefer to visualize the data using graphs, that's fine. I've chosen a plot resembling a *Cleveland* dot plot (something between a bar and dot plot), with the line showing the size of the caucus and colors alluding to the colors of the Brazilian parties. The graph is made with the **ggplot2** library along with the **SciencesPo** theme `theme_fte`.

```{r highestAverages12, echo=TRUE, message=FALSE, comment=NA, fig.width=5, fig.height=4.5, fig.align="center"}

gg <- ggplot()
gg <- gg +  geom_lollipop(data=mytable, aes(x = reorder(Party, Seats), y = Seats, color = Party), point.size = 3)
gg <- gg + geom_label(data=mytable, aes(x = reorder(Party, Seats), y = Seats + .5, label = Seats), hjust = 0) 
gg <-  gg + scale_y_continuous(expand = c(0, 0), limits = c(0, 25))
gg <- gg + scale_color_parties("BRA") + scale_fill_parties("BRA")
gg <- gg + coord_flip()
gg <-  gg + labs(list(x = "", y = "Number of seats obtained",
            title="The 2014 Brazilian elections in Ceará, \n Seats won by party"))
gg <-  gg + theme_fte(horizontal = FALSE)
gg <-  gg + theme(panel.grid.major.y=element_blank()) 
gg <-  gg + theme(legend.position = "none") 
gg

```


Next, I use the same example to make a plot comparing three highest-averages formulas. The plot is decorated with the **SciencesPo** theme `theme_fte` and color its scale colors.  

```{r largestRemainders5, eval=TRUE, echo=TRUE, message=FALSE, fig.width=6, fig.height=3.5, fig.align="center", fig.cap= "2014 Legislative Election in Ceará (M=42)"}

out1 = HighestAverages(parties=names(Ceara), votes=Ceara, 
                seats = 42, method = "dh")
out2 = HighestAverages(parties=names(Ceara), votes=Ceara, 
                seats = 42, method = "imperiali") 
out3 = HighestAverages(parties=names(Ceara), votes=Ceara, 
                seats = 42, method = "sl")

# add the method:
out1$Method = "d'Hondt"
out2$Method = "imperiali"
out3$Method = "Saint-Laguë"


data <- rbind(out1, out2, out3)

p = ggplot(data=data, aes(x=reorder(Party, -Seats), y=Seats, fill=Method)) +
    geom_bar(stat="identity",position=position_dodge()) +
   labs(x="", y="Seats")
p + scale_fill_fte() + 
  theme_538(legend = "top", base_size = 10) 
```


```{r largestRemainders6, eval=FALSE, echo=TRUE, message=FALSE, fig.width=7, fig.height=4.5, fig.align="center", fig.cap= "2014 Legislative Election in Ceara (M=42)"}

#2014 Federal elections, 30 seats to be returned in the state of Parana, Brazil.

PR=c("PSDB/DEM/PR/PSC/PTdoB/PP/SD/PSD/PPS"=2601709,
     "PT/PDT/PRB/PTN/PCdoB"=1109905, 
     "PSDC/PEN/PTB/PHS/PMN/PROS"=501148,
     "PV/PPL"=280767)
```



```{r largestRemainders7, eval=FALSE, echo=TRUE, message=FALSE, fig.width=7, fig.height=4.5, fig.align="center", fig.cap= "2014 Legislative Election in Ceara (M=42)"}

2014 Federal elections, 70 seats to be returned in the state of Sao Paulo, Brazil.
SP=c("PSDB/DEM/PPS"=5537630, "PT/PCdoB"=3170003,
     "PMDB/PROS/PP/PSD"=2384740, "PSOL/PSTU"=462992,
     "PSL/PTN/PMN/PTC/PTdoB"=350186, "PHS/PRP"=252205)


```


# Measures of Political Diversity 

```{r politicalDiversity1, echo=TRUE, message=FALSE, comment=NA}
# The 2004 presidential election in the US (vote share):

US2004 <- c("Democratic"=0.481, "Republican"=0.509, 
            "Independent"=0.0038, "Libertarian"=0.0032, 
            "Constitution"=0.0012, "Green"=0.00096,
            "Others"=0.00084)

print(US2004)
```


```{r politicalDiversity2, echo=TRUE, message=FALSE, comment=NA}
PoliticalDiversity(US2004); # ENEP (laakso/taagepera) method 
```

```{r politicalDiversity3, echo=TRUE, message=FALSE, comment=NA}
PoliticalDiversity(US2004, index= "golosov");
```

```{r politicalDiversity4, echo=TRUE, message=FALSE, comment=NA}
PoliticalDiversity(US2004, index= "herfindahl");
```

Considers the following `data.frame` with electoral results for the 1999 election in Helsinki, the seats were allocated using both Saint-Laguë and D'Hondt methods so we can compare the effect of the allocation formulas on the effective number of parties.  

```{r Helsinki-election, echo=TRUE, message=FALSE}
# Helsinki's 1999

Helsinki <- data.frame(
  votes = c(68885, 18343, 86448, 21982, 51587,
            27227, 8482, 7250, 365, 2734, 1925,
            475, 1693, 693, 308, 980, 560, 590, 185),
  seats.SL=c(5, 1, 6, 1, 4, 2, 1, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0, 0),
  seats.dH=c(5, 1, 7, 1, 4, 2, 0, 0, 0, 0, 0, 0, 0, 0,
             0, 0, 0, 0, 0))
```


```{r politicalDiversity5, echo=TRUE, message=FALSE, comment=NA}
# PoliticalDiversity(Helsinki$votes); #ENEP Votes

PoliticalDiversity(Helsinki$seats.SL); #ENP for Saint-Lague

PoliticalDiversity(Helsinki$seats.dH); #ENP for D'Hondt
```


# Measures of Disproportionality

What is electoral disproportionality? A perfectly proportional election is one that every party wins seats in exact proportion to its share of the votes. That is, a party with 25% of the votes wins 25% of the seats, a party with 5% of the votes wins 5% of the seats, and so on. To measuring and compare the level of disproportionality from this ideal, there are quite a few mehtods, however, which one is measures it best is far from clear.
 
Let's consider the following two real-data examples taken from the Wikipedia. These two sets of data refer to subnational elections, one from Queensland (Australia) and the other from Quebec (Canada).  

```{r Queensland-election, echo=TRUE, cache=TRUE}
# 2012 Queensland state elecion:
Queensland <- data.frame(party = c("LNP", "ALP", "Katter", "Greens", "Ind", "Others"),
                         votes = c(1214553,652092,282098,184147,77282,35794),
                         pvotes = c(49.65, 26.66, 11.5, 7.53, 3.16, 1.47),
                         seats = c(78, 7, 2, 0, 2, 0),
                         pseats = c(87.64, 7.87, 2.25, 0.00, 2.25, 0.00))
```


```{r Quebec-election, echo=TRUE, cache=TRUE}
# 2012 Quebec provincial election:
Quebec <- data.frame(party = c("PQ", "Lib", "CAQ", "QS", "Option", "Other"),
                         pvotes = c(31.95, 31.20, 27.05, 6.03, 1.89, 1.88),
                         pseats = c(54, 50, 19, 2, 0, 0))
```

Most of the methods presented below are encompassed in a single function `Proportionality()`, but they can also evoked as standalone functions.

## The Gallagher Index

```{r eval=FALSE, proportionality1, echo=TRUE, message=FALSE, comment=NA}

with(Queensland, Gallagher(pvotes, pseats))

with(Quebec, Gallagher(pvotes, pseats))

# The same as above
with(Queensland, Proportionality(pvotes, pseats, 
                     index = "Gallagher") )
```


## The Lijphart's Index of Proportionality

```{r eval=FALSE, proportionality2, echo=TRUE, message=FALSE, comment=NA}
with(Queensland, Lijphart(pvotes, pseats))

with(Quebec, Lijphart(pvotes, pseats))

# The same as above
with(Queensland, Proportionality(pvotes, pseats, 
                     index = "Lijphart") )
```


## The Grofman Index

```{r eval=FALSE, proportionality3, echo=TRUE, message=FALSE, comment=NA}
with(Queensland, Grofman(pvotes, pseats))

with(Quebec, Grofman(pvotes, pseats))

# The same as above
with(Queensland, Proportionality(pvotes, pseats, 
                     index = "Grofman") )
```


## Farina Index

```{r eval=FALSE, proportionality4, echo=TRUE, message=FALSE, comment=NA}
with(Queensland, Farina(pvotes, pseats))

with(Quebec, Farina(pvotes, pseats))

# The same as above
with(Queensland, Proportionality(pvotes, pseats, 
                     index = "Farina") )
```


## The Cox-Shugart measure of proportionality

```{r eval=FALSE, proportionality5, echo=TRUE, message=FALSE, comment=NA}
with(Queensland, CoxShugart(pvotes, pseats))

with(Quebec, CoxShugart(pvotes, pseats))

# The same as above
with(Queensland, Proportionality(pvotes, pseats, 
                     index = "Cox-Shugart") )
```


## The inverse Cox-Shugart measure of proportionality

```{r proportionality6, echo=TRUE, message=FALSE, comment=NA}
with(Queensland, inv.CoxShugart(pvotes, pseats))

with(Quebec, inv.CoxShugart(pvotes, pseats))
```


# Measures of Inequality and Concentration
I will write soon... 



```{r  eval=FALSE, echo=FALSE, message=FALSE, comment=NA}
sessionInfo()
```


# References

Cowell, F. A. (2000) Measurement of Inequality in Atkinson, A. B. / Bourguignon, F. (Eds): Handbook of Income Distribution. Amsterdam.

Cowell, F. A. (1995) Measuring Inequality Harvester Wheatshef: Prentice Hall.

Benoit, Kenneth. (2000) "Which Electoral Formula is the Most Proportional? A New Look with New Evidence." Political Analysis 8(4): 381-388.

Blais, A., and L. Massicotte (1997) Electoral Formulas: A Macroscopic Perspective, European Journal of Political Research, 32, 107–129.

Gallagher, Michael and Paul Mitchell (2005) The Politics of Electoral Systems. Oxford University Press.

Gallagher, Michael (1992) "Comparing Proportional Representation Electoral Systems: Quotas, Thresholds, Paradoxes and Majorities". British Journal of Political Science, 22, 4, 469-496.

Gallagher, M. (1991) Proportionality, disproportionality and electoral systems. Electoral Studies 10(1):33-51.

Golosov, Grigorii (2010) The Effective Number of Parties: A New Approach, Party Politics, 16: 171-192.

Laakso, Markku and Rein Taagepera (1979) Effective Number of Parties: A Measure with Application to West Europe, Comparative Political Studies, 12: 3-27.

Lijphart, Arend (1994) Electoral Systems and Party Systems: A Study of Twenty-Seven Democracies, 1945-1990. Oxford University Press.

Nicolau, Jairo (2008) Sistemas Eleitorais. Rio de Janeiro, FGV.

Norris, Pippa (1997) Choosing electoral systems: proportional, majoritarian and mixed systems.

Taagepera, R., and B. Grofman (2003) Mapping the indices of seats-votes disproportionality and inter-election volatility. Party Politics 9, 6: 659-77.

Taagepera, Rein and Matthew S. Shugart (1989) Seats and Votes: The Effects and Determinants of Electoral Systems. New Haven: Yale University Press.

